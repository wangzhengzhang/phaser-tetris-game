<!DOCTYPE html>
<html>
  <head>
    <title>俄罗斯方块</title>
    <link rel="stylesheet" href="page_load.css" />
  </head>
  <body>
    <!-- 进度条覆盖层 -->
    <div class="progress-overlay" id="progressOverlay">
      <h2>loading... <span id="progressPercent">0%</span></h2>
      <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div class="resource-list" id="resourceList"></div>
    </div>
    <div id="mainContent">
      <h1>load resource compete...</h1>
    </div>
    <div id="mainHiddenContent"></div>
  </body>
</html>
<script>
  const jsFiles = [
    // 先加载引擎，再加载业务逻辑
    "./phaser.min.js", // 加载引擎
    "https://cdn.tailwindcss.com",
    "./tailwind-config.js",
    "./main.js",
    "./storage_manager.js",
    "./dialog.js",
    "./game.js",
  ];

  const cssFiles = [
    "https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css",
    "https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css",
  ];

  function initApplication() {
    console.log("load resource complate. begin initApplication.");

    // 立即执行的 async 函数
    (async () => {
      console.log("start init application async...");
      const result = await includeHTML("main.html", "mainContent"); // 等待异步操作
      initGame();
      initMain();
      initStorageManager();
      await initDialog(); // 等待异步操作
    })();
  }
</script>
<script defer src="./page_load.js"></script>
